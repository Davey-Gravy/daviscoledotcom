{{ define "main" }}
  <header class="article-header">
    <h1>{{ .Title }}</h1>
    {{ with .Content }}
      <div class="article-content">
        {{ . }}
      </div>
    {{ end }}
  </header>

  {{ $albums := .Pages }}
  {{ if eq (len $albums) 0 }}
    <p class="text-secondary">No albums yet.</p>
  {{ else }}
    <div class="albums-grid">
      {{ range $albums }}
        {{ $images := .Resources.ByType "image" }}
        {{ $cover := cond (.Params.cover) (.Resources.GetMatch .Params.cover) nil }}
        {{ if not $cover }}{{ $cover = .Resources.GetMatch "*cover*" }}{{ end }}
        {{ if not $cover }}{{ with index $images 0 }}{{ $cover = . }}{{ end }}{{ end }}

        <a href="{{ .RelPermalink }}" class="album-card">
          {{ with $cover }}
            <img src="{{ .RelPermalink }}" alt="{{ $.Title }}" loading="lazy">
          {{ else }}
            <div style="aspect-ratio: 4/3; display: flex; align-items: center; justify-content: center; background: var(--bg-tertiary); color: var(--text-tertiary);">
              No cover
            </div>
          {{ end }}
          <div class="album-card-title">{{ .Title }}</div>
        </a>
      {{ end }}
    </div>
  {{ end }}
{{ end }}
